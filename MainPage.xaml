<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:Goals.Converters"
             x:Class="Goals.MainPage"
             BackgroundColor="#FFFBEB">

    <ContentPage.Resources>
        <ResourceDictionary>
            <converters:StatusColorConverter x:Key="StatusColorConverter"/>
            <converters:PriorityColorConverter x:Key="PriorityColorConverter"/>
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,*,Auto" Padding="20">
        
        <!-- Page Title -->
        <Label Grid.Row="0"
               Text="My Goals" 
               FontSize="{OnIdiom Phone=28, Tablet=34, Desktop=40}"
               FontAttributes="Bold"
               TextColor="#1F2937"
               HorizontalOptions="Center"
               Margin="0,10,0,20"/>

        <!-- Goals Collection -->
        <CollectionView Grid.Row="1"
                       x:Name="GoalsCollection" 
                       SelectionMode="Single"
                       SelectionChanged="OnGoalSelected">
            <CollectionView.ItemsLayout>
                <GridItemsLayout Orientation="Vertical">
                    <GridItemsLayout.Span>
                        <OnIdiom x:TypeArguments="x:Int32" 
                                 Phone="1" 
                                 Tablet="2" 
                                 Desktop="2"/>
                    </GridItemsLayout.Span>
                </GridItemsLayout>
            </CollectionView.ItemsLayout>
            
            <CollectionView.EmptyView>
                <Label Text="No goals yet. Tap 'Add new goal' to create one."
                       FontSize="{OnIdiom Phone=24, Tablet=34, Desktop=40}"
                       TextColor="#6B7280"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"/>
            </CollectionView.EmptyView>
            
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame BorderColor="#F97316"
                           BackgroundColor="White"
                           CornerRadius="12"
                           Padding="15"
                           Margin="5"
                           HasShadow="True">
                        
                        <VerticalStackLayout Spacing="8">
                            <Label Text="{Binding Title}"
                                   FontSize="{OnIdiom Phone=18, Tablet=24, Desktop=28}"
                                   FontAttributes="Bold"
                                   TextColor="#1F2937"/>
                            
                            <Label Text="{Binding Description}"
                                   FontSize="{OnIdiom Phone=14, Tablet=18, Desktop=20}"
                                   TextColor="#1F2937"
                                   LineBreakMode="WordWrap"/>
                            
                            <Label Text="{Binding DueDate, StringFormat='Due: {0:MMM dd, yyyy}'}"
                                   FontSize="{OnIdiom Phone=14, Tablet=18, Desktop=20}"
                                   TextColor="#6B7280"
                                   Margin="0,5,0,0"/>
                            
                            <HorizontalStackLayout Spacing="10">
                                <Frame BackgroundColor="{Binding Status, Converter={StaticResource StatusColorConverter}}"
                                       Padding="8,4"
                                       CornerRadius="6"
                                       HasShadow="False">
                                    <Label Text="{Binding Status}"
                                           FontSize="{OnIdiom Phone=14, Tablet=18, Desktop=20}"
                                           TextColor="White"
                                           FontAttributes="Bold"/>
                                </Frame>
                                
                                <Frame BackgroundColor="{Binding Priority, Converter={StaticResource PriorityColorConverter}}"
                                       Padding="8,4"
                                       CornerRadius="6"
                                       HasShadow="False">
                                    <Label Text="{Binding Priority}"
                                           FontSize="{OnIdiom Phone=14, Tablet=18, Desktop=20}"
                                           TextColor="White"
                                           FontAttributes="Bold"/>
                                </Frame>
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        
        <!-- Add New Goal Button -->
        <Button Grid.Row="2"
                Text="Add new goal"
                BackgroundColor="#F97316"
                TextColor="White"
                FontSize="{OnIdiom Phone=16, Tablet=20, Desktop=22}"
                FontAttributes="Bold"
                CornerRadius="8"
                HeightRequest="50"
                WidthRequest="180"
                HorizontalOptions="End"
                VerticalOptions="End"
                Margin="0,10,0,0"
                Clicked="OnAddGoalClicked"/>
    </Grid>

</ContentPage>
